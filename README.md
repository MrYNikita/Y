# YModules

[![npm version](https://img.shields.io/npm/v/ymodules.svg)](https://npmjs.org/package/ymodules)    
[![GitHub license](https://img.shields.io/badge/license-Apache_2.0-darkblue.svg)](https://github.com/MrYNikita/YModules)    
[![npm downloads](https://img.shields.io/npm/dm/ymodules.svg)](https://npmjs.org/package/ymodules)  

***
**YModules** - это совокупность функций и классов, предоставляющих частоиспользуемые и оптимизированные процедуры и структуры данных.  

***
## Основные преимущества:
- Отсутсвие сторонних зависимостей.
- Регулярная оптимизация алгоритмов.
- Устранение необходимости в повторном написании однотипного кода, используемого в разных проектах.
***
## Содержание
1. **Теория**
    1. Версионная расшифровка
    1. Приёмы
        1. **Умное заполнение**
        1. **Глубокое взаимодействие**
    1. Паттерны
        1. **Объекты носители аргументов**
        1. **Типы паттернов**
            1. Type
                - TB
            1. Function
                1. Функциональные цепочки
                    - ADVHC
                    - BDVHC
            1. Classes
                1. Классовые цепочки
                    - SDFY
1. **Модули**   
    1. OS
    1. Web
    1. Log
    1. Ject
        - Классы:
        - Функции:
            - Fill
            - DeepSet
            - DeepGet
            - DeepChange
            - DeepSupplement
    1. Func
    1. Error
    1. Array
    1. String
    1. Number
1. **Изменения**
    1. Удаления
    1. Улучшения
    1. Добавления
    1. Исправления
1. **Комментарий**
1. **Планы**
    
***
## Теория
### Версионная расшифровка
Версия задана форматом z.y.x, где z - номер версии проекта, y - номер обновления и x - номер правки. Версия обозначает изменение всего проекта, его концепций. Номер обновления указывает на добавление в указанную версию какого-то нового функционала. Правки описывают оптимазационные патчи и изменения функционала.
***
### Приёмы
#### Умное заполнение
Это приём классов SDFY, который позволяет заполнить объект с помощью D звена. Данное звено содержит все свойства, необходимые для заполнения экземпляра класса, без необходимости указывать каждое отдельное свойство.

Данный приём реализован за счет функциональной цепочки jectFill.


#### Глубокое взаимодействие
Это приём, который позволяет работать с объектом и всеми его свойствами без уровней вложенности, позволяя менять или получать доступ к свойствам вложенных объектов через основной.

Данный приём реализован за счет функциональных цепочек jectChange, jectGet, JectSet, jectSupplement.

***
### Паттерны
#### Объект носитель аргументов
**Объект носитель аргументов** - это объект, свойства которого являются аргументами для функций. Данные объекты обозначаются как t (transmit). Пример:

```js

    function test(t) { ... };
```    


Для данных объектов с помощью JSDoc создается тип, используя который могут быть обозначены ожидаемые свойства.

```js

    /**
     * @typedef t1
     * @prop {string} str Текстовое свойство.
     * @prop {number} num Числовое свойсвто.
    */
```


Для тех случаев, когда один объект носитель поолностью содержит свойства другого типа носителя аргументов, но имеет собственные уникальные свойства, следует использовать паттерн TB. Данный паттерн реализуется за счет создания промежуточного типа before, который содержит уникальные свойства и итогового типа, которые является совокупностью наследуемого и промежуточного типа.

```js
    
    /**
     * @typedef t1
     * @prop {string} str Текстовое свойство.
     * @prop {number} num Числовое свойсвто.
    */

    /**
     * @typedef tb2
     * @prop {boolean} boo Логическое свойство.
     * @typedef {t1&tb2} t2
    */
```


Далее необходимо использовать данный тип.

```js

    /**
     * ...
     * @param {t2} t
    */ 
    function test(t) { ... };
```


Данный объект носитель аргументов используется в функциональных цепочках, где один единственный объект передается аргументом для всех функций, вызванных по цепочке.

***
#### Type

- TB    
    TB - (transmit before) - это паттерн создания JSDoc типов. С помощью данного паттерна создаются типы, определяющие вид объектов носителей аргументов и правила их формирования. Созданные типы используются в основном для создания ожидаемого объекта.   

    Паттерн TB выделяет свойства типов называемые избыточными - это такие свойства, которые могли быть обретены в следствии совокупности.
    > Предупреждение! Использование этого паттерна требует оптимального создания типов. Это означает, что создаваемые типы должны не должны содержать избыточные свойства.   

    > Уточнение! Для того, чтобы устранить избыточные свойства следует создвавать промежуточные типы, используемые исключительно для перечисления необходимых свойств.

***
#### Function
1. Функциональные цепочки   
Функциональные цепочки - это функция отдельные логические части которой, преобразованны в совокупность последовательно выполняемых функций, представленных цепочкой вызов. Каждый отдельный вызов функции в цепи называется звеном. Каждое отдельное звено выпролняет свою логическую часть. Результат всех вызовов возвращается в изначальное звено вызова.

**Преимущетсва**:
- Вынесение логики.
- Упрощенная навигация.

Для расмотрения предлагаются варианты функиональных цепочек.

**Виды**:
1. DVHC   
    *Deceit Verify Handle Comply* - Это вариант функциональной цепочки, который включает в себя этапы: отлова, проверки, обработки, исполнения. В качестве аргумента любая функциональная цепочка DVHC принимает объект-носитель аргументов. Каждое звено цепи возвращает значение вызова последующего звена. Последнее звено цепи C исполняет основную заложенную логику и возвращает итоговое значение. Предполагается, что каждое звено цепи представлено в единственном экземпляре.
    
    D - (Deceit) - этап отлова. Данное звено оборачивает все последующие звенья в единый блок отлова исключительных ситуаций. В случае исключительной ситуации, данное звено либо прервет исполнение программы вызовом ошибки, либо вернет определенное автором исключительное значение.   
    V - (Verify) - этап проверки. Данное звено осуществляет проверку объекта-носителя аргументов. Если объект носитель аргументов содержит ошибочные свойства, то данное звено вернет определенную для проверки исключительную ситуацию.   
    H - (Handle) - этап обработки аргументов. Данное звено осуществляет обработку объекта-носителя аргументов, если они соответсвуют условиям обработки.    
    C - (Comply) - этап исполнения. Данное звено осуществляет исполнение основной логики функциональной цепочки.

    1. ADVHC  
        *Aggregate's Deceit Verify Handle Comply* - это модификация функциональной цепочки DVHC, которая включает в себя звенья-дистрибьюторы. Каждое из данных звений может быть начальным.
        
        Все данные звенья предназначены для обращения к звену D и каждое из них обладает уникальным набором аргументов. Аргументы данных звеньев могут быть отличными от объекта-носителя аргументов - это сделано для удобства обращения к функциям, чьё кол-во аргументов мало и может быть сведено к последовательности. Однако логика своих звеньев подразумевает обращение к D, что требует в логике каждого такого звена приводить все перечисленные аргументы к объекту-носителю аргументов.  
        
        Каждое такое звено должно обладать своей документацией с указанием типа для каждого параметра. В документации к функции можно опустить указание @return в тех случаях когда функция всегда возвращает единственное значение. Исключением могут быть те звенья, логика которых заключается в возвращении одного элемента, несмотря на то, что C звено возвращает массив элементов. В противном случае не рекомендуется указывать значения отличные от значения звена C.

        > Предупреждение! При указании @return в документации к звену-дистрибьютору следует указывать значение исключительной ситуации, если такое указано в звене D.

    1. BDVHC  
        *Before Deceit Verify Handle Comply* - это функциональная цепочка, которая включает в себя звено-предъобработки. Такое звено является начальным и единственным.

        Звенья-предобработчики предназначены для приведения последовательнсоти аргументов к форме объекта носителя аргументов. Их логика изучает последовательность и на основе заложенной в звено логики формирует объект-носитель аргументов, который в дальнейшем проходит стандартную цепочку DVHC.

        Данные функциональные цепочки используются в классах, чтобы имитировать переопределение конструктора. В такой реализации, звено не вызывает следующих элементов цепи. Вместо этого звено возвращает объект-носитель аргументов.

        По сути BDVHC является точной копией ADVHC

        > Уточнение! B не вызывает последующие элементы функциональной цепи. Это связано с тем, что констурктор вынужден вызывать метод super, который может быть вызван только в его теле. Всвязи с этим вызов из звена невозможен. Если бы B продолжал цепь до вызова C, то звено C изменило бы this до объявления конструктора.
***
#### Classes
1. Классовые цепочки    
    Классовые цепочки - это последовательности классов, которые разделены на логические звенья. Каждое звено ответсвтенно за собственную логику.
    > Пример! Вся статика вынесена в специальное статическое звено. Таким образом вся статика сконцентрирована в единтсвенном классе.

**Преимущества**
- Вынесение логики.
- Упрощенная навигация.

**Виды**    
1. SDFY   
*Static Data Fill Y* - Это вариант классовых цепочек, при котором создается последовательность классовых звеньев SDFY. Данный паттерн подразумевает наличие в цепи едиснтвенного конструктора. Внутри конструктора используется функциональная цепочка BDVHC - это даёт возможность передавать в конструктор итогового класса как объект-носитель аргментов, так и последовательность аргментов.
> Предупреждение! Рекомендуется использовать вариант с объетками-носителями аргументов. Данный вариант предпочтителен, так как позволяет пользователям использовать intellisense.

***
## Модули
### OS
Данный модуль позволяет гибко управлять файлами и директориями проекта. 

**Преимущества**
- Позволяет работать с файлами, как с объектами.
- Может найти любой файл в проекте по фрагменту его пути.

**Функции**
- #### **getPath**
    
- #### **getPathAll**
    Получить массив всех путей проекта, можно использовать метод `getPathAll`. За счёт указанного метода будет получен массив всех путей проекта.
    ```js
        // Массив всех путей проекта.
        const paths = getPathAll();
    ```
    При необходимости можно получить те файлы, которые будут соответсвовать определенным условиям.

**Классы**

***
## Изменения
- Удаления
    - YString
        - Убран режим рассинхронных курсоров.
- Улучшения
    - string.YCursor -> ject.YCursor
        - Курсоры были вынесены за рамки модуля строк и переданы модулю объектов.
    - string
        - castToYReport
            - Теперь все значения после двоеточия подсвечиваются светло-желтым.
            - Теперь все значения true и false заменяются на + и - соотвественно.
    - YArray
        - Наследуется от YList.
        - Были добавлены курсоры.
    - YString
        - Наследуется от YList.
        - Строки могут табулироваться.
        - При передаче в метод paste другой YString, нет необходимости вызывать метод get - он вызывается внутри метода.
    - YServer
        - Теперь может отправлять html документ созданный YHTML классом.
- Добавления
    - func
        - Добавлен класс YFunc - класс исполняемых функций.
        - Добавлен класс YProc - класс исполняемых процедур.
    - YProc
        - Добавлено свойство функции исполнения.
        - Добавлено свойство метки.
        - Добавлено свойство категории.
    - YFunc
        - Добавлен метод exec для выполнения функции.
        - Добавлен метод finish для досрочного завершения функции.
        - Добавлен метод moveIndexByAlias для перемещения индекса исполнения в место указанной метки.
        - Добавлен метод filterByCategory для фильтрации процедур по категориям.
        - Добавлен метод создания новых процедур.
        - Добавлен метод размещения новых процедур.
    - ject
        - Добавлен класс YList.
    - html
        - Добавлен класс YHTML для работы с html документами.
    - YHTML
        - Добавлен макет стандартной html страницы.
        - Добавлены области внедрения скриптов.
        - Добавлена область установки скрипта инициализации по умолчанию.
        - Добавлен метод get для получения документа в виде строки.
    - string
        - Добавлена ФЦ convertCamelCaseToDelimetr для конвертации строки CamelCase в строку с разделителем.
    - YString
        - Добавлено свойство индекса табуляции.
        - Добавлено свойство указания значения табуляции.
        - Добавлены методы регулирования табуляции.
        - Добавлен метод очистки clearPrePostfix для сброса значений префикса и постфикса.
    - YCursor
        - Добавлен эффект распределения влияния для курсоров. Этот эффект обеспечивает поглощение малых курсоров крупными курсорами, чья область влияния полностью охватывает места размещения малых курсоров.
        - Добавлен метод absorb для поглощения курсором других курсоров согласно правилу влияния.
    - array
        - Добавлена ФЦ countSignificant для подсчета непустых элементов массива.
        - Добавлен класс YArray - класс массивов.
        - Добавлен класс YArrayRank - класс размерных массивов.
    - YArray
        - Добавлены курсоры.
        - Добавлен метод push добавления в конец массива.
        - Добавлен метод paste вставки.
    - number
        - Добавлена ФЦ getNearstIndex для получения ближайших индексов к указанному значению.
        - Добавлен класс YRange для работы с числовыми диапазонами.
        - Добавлен модуль sequence.
    - sequence
        - Добавлена ФЦ checkEntry.
        - Добавлен класс YSequence.
    - YSequence
        - Добавлено определение минимального значения последовательности.
        - Добавлено определение максимального значения последовательности.
        - Добавлено определение кол-ва правильных последовательностей (от большего к меньшему, с разницей между соседними элементами в 1 шаг).
        - Добавлено определение кол-ва чисел.
        - Добавлен метод проверки на принадлежность последовательности.
    - YStyle
        - Добавлен класс YStyleSet
    - YStyleSet
        - Добавлен обработчик аргумента приводящий строку camelCase к виду строки с разделителем.
        - Добавлен свойство property с перечислением вариантов возможных значений.
        - Добавлен метод получения строки свойства и значения.
- Исправления
    - string
        - handle
            - Исправлена обработка строк, в качестве фрагментов.
    - YCursor
        - Свойство array (оно же string) переименовано в list.
        - Свойство list курсоров ссылается на класс YList вместо ссылки на YString и YArray.
    - YStyleElement
        - Исправлена документация свойств. Теперь они воспринимаются как массивы.

***
## Комментарий
**21**  
Данное обновление содержит множество изменений. Подробнее об изменениях можно будет прочитать в будущих версиях документации.

**YFunc**   
Этот класс предназначен для выполнения совокупности функций. С его помощью можно создавать последовательности выполнения `YProc` (процедур), которые могут выполняться в заданном порядке. Основным преимуществом функций данного типа является повышение производительности при конверсии в память.

**Формирование порядка последовательности**     
Для формирования последовательнсоти используются методы экземпляра `YFunc`. С их помощью могут создаваться новые процедуры и удаляться уже имеющиеся. Также с помощью отдельного метода можно размещать процедуры или убирать их из последовательности.

> **Информация**. Важно понимать разницу между **созданием** процедуры и её **размещением**. Созданная процедура будет храниться в памяти `YFunc`, но может быть так и никогда не использована. Для того, чтобы процедура была исполнена, необходимо, чтобы она стала частью последовательности `YFunc`, то есть была размещена в последовательности.

**Процесс выполнения YFunc**    
Созданную функцию можно запустить методом `exec`. Данный метод приведет функцию к исполнению заданной для неё последовательности процедур. В начале функция создаст свою исходную копию. Это сделано для того, чтобы уже запущенная функция не могла быть изменена в ходе изменения родительской функции. После запуска функция начинает своё выполнение с процедуры входа - это та процедура, которая в последовательности выполнения функции идет первой по порядку.

Каждый экземпляр `YProc` (процедуры) содержит функцию, которая выполняется в тот момент, когда наступает очередь процедуры. Запуск этой функции происходит с помощью метода `apple`, который указывает функции, что её внутренний контекст заменяется на её экземпляр `YFunc`. С помощью этого действия, функия может получить доступ к последовательности исполнения. 

**Фильтрация типов процедур и контроль порядка**    
Доступ к последовательности исполнения открывает возможности для создания внутри последовательности динамичных циклов. Их динамика заключается в том, что из цикла могут быть убраны процедуры или могут быть добавлены новые. Таким образом можно оптимизировать процесс выполнения кода, избегая избыточных проверок, лишних действий и т.д. за счет данной особенности - для этого достаточно лишь размещать отдельные части алгоритма в процедуры и осуществлять контроль над данными процедурами, убирая или добавляя их по мере необходимости.

Для удобства, `YFunc` позволяет убирать из последовательности процедуры по категориям. Присвоить категорию или несколько таковых можно процедуре на момент создания. Указав категории фильтрации, вы сможете избежать выполнения тех процедур, которые попали под категорию фильтруемых.

Для контроля последовательности также могут использоваться методы перемещения индекса последовательности. Для удобства, перемещение можеет осуществляться по меткам процедур, вместо указания их индекса в последовательности, который может быть сложно определить.

**YSequence**   
Последовательности - это набор чисел. Несмотря на этот факт, в них могут храниться и символы (будут преобразованы в коды). С их помощью можно анализировать последовательности чисел на вхождения, пересечений, определение смежных областей, областей пересечения, областей отсечения.

С помощью сжатия диапазонов, последовательности уменьшают потребление памяти не теряя информации о входящих в них значениях. Способствуют этому правильные последовательности.

**Правильные последовательности**   
Важный термин, который часто используется в последовательностях - это их правильность. Правильными здесь считаются те последовательности, элементы которой отсортированы в порядке возрастания и разниа между которыми не превышает размера шага. Пример правильной последовательности: `[1, 2, 3, 4, 5]`. Для YSequence данная последовательность будет сжата до вида: `[1, 5]`. Несмотря на сжатие значения внутри диапазона не потеряны и учитываются экземплярами класса последовательностей.

**YHTML**   
Класс, позволяющий создавать разметку html и видоимзенять её исключительно js кодом. С помощью класса можно определять скрипты заголовка и тела, титульное имя, подключения css. Также класс позволяет указать скрипт инициализации, который выполняет все функции, указанные для него кодом, а не подключением файла скрипта.

Инициализатор также позволяет разместить в документе те объекты, которые необходимы YModules для работы своих модулей. На данный момент к таковым относятся объекты стилей.

***
## Планы
- [ ] Модификация path.
    - [ ] Добавление ФЦ прокладки относительного пути от файла до файла.
- [ ] Модификация YFile.
    - [ ] Статика.
    - [ ] Асинхронность.
- [ ] Модификация YNotice.
    - [ ] Группы уведомлений.
- [ ] Переписывание классов модулей на SDFY-2.0.
    - [x] YAPI.
    - [x] YRout.
    - [x] YFile.
    - [x] YStyle.
    - [x] YString.
    - [x] YServer.
    - [x] YElement.
    - [x] YDirectory.
    - [x] YStyleElement.
    - [ ] YRegExp.
    - [ ] YRegExpSymbol.
    - [ ] YRegExpVariate.
    - [ ] YRegExpBracket.
- [ ] Создание модуля CLI.
- [ ] Создание модуля os.stream.
- [ ] Создание вложенного модуля CLI.YCLI.
- [ ] Создание вложенного модуля log.YLog.
- [x] Создание вложенного модуля web.html.
- [ ] Создание вложенного модуля web.html.plot.
- [ ] Создание вложенного модуля web.html.style.    
    - [ ] Оптимизатор стилей.
- [ ] Создание вложенного модуля web.html.fetch.
- [x] Создание вложенного модуля web.html.element. 
    - [ ] create
        - [ ] createByString
            - [ ] Убрать рекурсию.
            - [ ] Добавить возможность указания параметров.
    - [x] Возможность указания параметров в формате единой строки.
    - [x] Размещение элементов в над элементах.
    - [x] Перемещение элементов.
    - [x] Удаление элементов.
    - [x] Создание класса элементов.
    - [x] Заполнение класса.
    - [x] Возможность указывать в строке вложенные элементы в виде аналогичных строк.
    - [x] Учет и группировка элментов.
    - [x] Аналоги компонентам React или структуры.
- [ ] Модификация YServer
    - [ ] Система ролей
    - [ ] Генерация паролей
    - [ ] Система регестрации
- [ ] Создание вложенного модуля web.html.animation.    
- [ ] Доработка документации.       
    - [ ] Привести разбор модулей.  
    - [ ] Привести примеры использования.
- [ ] Внедрение строки условия объекта носителя аргумента.